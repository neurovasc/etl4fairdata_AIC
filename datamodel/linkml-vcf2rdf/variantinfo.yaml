id: https://example.org/aiccohortvariants
name: sequence_alteration
description: "Schema for describing sequence alterations (SO:0001059) and their relationships."
prefixes:
  rdfs: https://www.w3.org/2000/01/rdf-schema#
  linkml: https://w3id.org/linkml/
  so: http://purl.obolibrary.org/obo/SO_
  faldo: http://biohackathon.org/resource/faldo#
  geno: http://purl.obolibrary.org/obo/GENO_
  sio: http://semanticscience.org/resource/
  owl: http://www.w3.org/2002/07/owl#
  aic: https://example.org/aiccohortvariants#
  mondo: http://purl.obolibrary.org/obo/MONDO_
  hpo: http://purl.obolibrary.org/obo/HP_
  ncit: http://purl.obolibrary.org/obo/NCIT_
default_range: string
imports:
  - linkml:types

classes:
  # Sequence Alteration / Variation
  SequenceAlteration:
    class_uri: so:0001059 
    description: "A representation of a sequence alteration (so:0001059)."
    attributes:
      has_identifier:
        description: "A unique identifier for the sequence alteration."
        required: true
        range: string
        slot_uri: sio:000300
      has_reference_allele:
        description: "Links the sequence alteration to its reference allele (geno:0000036) using the property geno:0000385."
        required: true
        range: ReferenceAllele  # Updated to reference the new class
        slot_uri: geno:0000385
      has_alternate_allele:
        description: "Links the sequence alteration to its alternate allele (geno:0000002) using the property geno:0000382."
        required: true
        range: AlternateAllele  # Updated to reference the new class
        slot_uri: geno:0000382
      has_location:
        description: "Links the sequence alteration to its location using the property faldo:Region."
        required: true
        range: VariationSite
        slot_uri: faldo:location
      is_associated_with:
        description: "Links the sequence alteration to a phenotype (female), clinical trait (diabetes) or grouping (whole cohort)."
        required: true
        multivalued: true
        range: AssociatedCharacteristic
        slot_uri: sio:001403
  # Alleles
  ReferenceAllele:
    class_uri: geno:0000036  # Define a class for the reference allele
    description: "Represents the reference allele (geno:0000036)."
    attributes:
      value:
        description: "The value of the reference allele."
        required: true
        range: string
        slot_uri: sio:000300
  AlternateAllele:
    class_uri: geno:0000002  # Define a class for the alternate allele
    description: "Represents the alternate allele (geno:0000002)."
    attributes:
      value:
        description: "The value of the alternate allele."
        required: true
        range: string
        slot_uri: sio:000300
  # Location/Position of the sequence alteration  
  VariationSite:
    class_uri: faldo:Region
    description: "Represents the location of a sequence alteration."
    attributes:
      begins_at:
        description: "The beginning of the location of the sequence alteration."
        required: true
        range: VariationSiteBegin
        slot_uri: faldo:begin
      ends_at:
        description: "The end of the location of the sequence alteration."
        required: true
        range: VariationSiteEnd
        slot_uri: faldo:end
      has_reference:
        description: "The reference sequence (contig, sequence, chromosome)."
        required: true
        range: VariationSiteReference
        slot_uri: faldo:reference
  # Coordinates
  VariationSiteBegin:
    class_uri: faldo:ExactPosition
    description: "Represents the beginning of the location of a sequence alteration."
    attributes:
      position:
        description: "The position of the beginning of the location of the sequence alteration."
        required: true
        range: integer
        slot_uri: faldo:position
  VariationSiteEnd:
    class_uri: faldo:ExactPosition
    description: "Represents the end of the location of a sequence alteration."
    attributes:
      position:
        description: "The position of the end of the location of the sequence alteration."
        required: true
        range: integer
        slot_uri: faldo:position
  # Reference Sequence
  VariationSiteReference:
    class_uri: so:0000353
    description: "Represents the reference sequence (contig, sequence, chromosome)."
    attributes:
      value:
        description: "The value of the reference sequence 
        (ena sequence i.e. https://www.ebi.ac.uk/ena/browser/view/CM000684.2)."
        required: true
        range: string
      label:
        description: "A human-readable label for the reference sequence."
        required: true
        range: string
        slot_uri: rdfs:label
      sameAs:
        description: "The value of the reference sequence in another database 
        (ncbi sequence i.e. https://www.ncbi.nlm.nih.gov/nuccore/NC_000022.11)."
        required: true
        range: string
        slot_uri: owl:sameAs
  # Associated Characteristics
  AssociatedCharacteristic:
    description: "Represents a phenotype, clinical trait or grouping associated with a sequence alteration."
    attributes:
      has_identifier:
        description: "A unique identifier for the associated characteristic."
        required: false
        range: string
        slot_uri: sio:000300
      label:
        description: "A human-readable label for the associated characteristic."
        required: false
        range: string
        slot_uri: rdfs:label
      has_zygosity:
        description: "The zygocity of the associated characteristic."
        required: false
        range: Zygosity
        slot_uri: geno:0000608
  # Zygosity
  Zygosity:
    class_uri: geno:0000133
    description: "Represents the zygosity of an associated characteristic."
    attributes:
      type:
        description: "The type of zygosity."
        required: true
        range: ZygosityType
        slot_uri: rdfs:type
      has_measurement_value:
        description: "Count of alternative alleles in individuals with a certain zygosity."
        required: true
        range: Count
        slot_uri: sio:000216
      has_frequency:
        description: "Frequency of the allele in indibiduals with a certain zygosity."
        required: true
        range: Frequency
        slot_uri: sio:000900
  # Frequency
  Frequency:
    description: "Represents the frequency of an allele in individuals with a certain zygosity."
    attributes:
      value:
        description: "The frequency value."
        required: true
        range: float
        slot_uri: sio:000300
  # Count
  Count:
    description: "Represents the count of alternative alleles in individuals with a certain zygosity."
    attributes:
      value:
        description: "The count value."
        required: true
        range: integer
        slot_uri: sio:000300
  # Container
  Container:
    attributes:
      variantcatalog:
        multivalued: true
        inlined_as_list: true
        range: SequenceAlteration
enums:
  # Zygosity Type
  ZygosityType:
    description: "Enumeration of zygosity types."
    permissible_values:
      Homozygous:
        description: "Homozygous site."
        meaning: geno:0000136
      Heterozygous:
        description: "Heterozygous site."
        meaning: geno:0000135
      Disomic:
        description: "Disomic site."
        meaning: geno:0000391

